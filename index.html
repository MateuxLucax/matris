<!DOCTYPE html>
<html lang="pt-BR">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="The best math game!">
	<!-- Favicon -->
	<link rel="shortcut icon" href="./assets/icons/favicon.png" />
	<link rel="apple-touch-icon" href="./assets/icons/favicon.png" />

	<title>Matris</title> <!-- MAThematical expression tetrIS -->
	<link rel="stylesheet" href="./assets/style.css"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@700&display=swap" rel="stylesheet">
</head>
<body>

	<header>
	<svg width="352" height="58" fill="none" xmlns="http://www.w3.org/2000/svg" aria-label="Matris Logo">
		<path
			d="M154.775 47.645l-1.366-4.53h-15.226l-3.348 14.318h-12.117L137.704 0h7.813v12.489H156.095l11.435 35.156h-12.755zm-8.621-35.156h-.637l-5.421 21h11.479l-5.421-21z"
			fill="#2CB67D" />
		<path
			d="M194.174 10.739l.08 46.694h-11.958l-.08-46.694h-10.981V0h38.962v10.739h-16.023zM229.936 57.433h-11.798V35.876h11.798v-9.228h-11.798V0h21.523c2.711 0 5.129.424 7.255 1.273 2.125.795 3.906 2.916 5.341 4.454 1.488 1.538 2.604 3.394 3.348 5.569.744 2.174 1.116 4.613 1.116 7.318 0 3.924-.851 7.292-2.551 10.102-1.701 2.811-4.119 4.667-7.254 5.569l5.819 13.364h-13.074l-4.225-11.773h-5.5v21.557zm6.855-30.785c2.817 0 4.757-.53 5.82-1.59 1.116-1.061 1.674-2.811 1.674-5.25V17.42c0-2.44-.285-3.623-1.285-4.623s-1-2.5-13.064-2.218v16.068h6.855zM330.716 57.433c-4.677 0-8.743-.77-12.197-2.307a25.17 25.17 0 01-.641-.296l6.528-8.402c-.235-.092.235.102 0 0 2.214.867 4.45 1.3 6.708 1.3 2.87 0 5.049-.636 6.537-1.91 1.488-1.272 2.232-3.101 2.232-5.488 0-1.962-.585-3.447-1.754-4.454-.884-.799-2.269-1.414-4.155-1.846l-11.797-2.38c-2.785-1.004-4.934-2.46-6.448-4.365-2.232-2.864-3.348-6.338-3.348-10.421 0-5.356 1.753-9.493 5.261-12.41C321.15 1.485 326.065 0 332.39 0c4.304 0 8.051.663 11.24 1.989.369.153.729.313 1.082.479l-6.369 8.25c-1.77-.675-3.728-1.013-5.874-1.013-5.367 0-8.051 2.2-8.051 6.602 0 1.91.585 3.341 1.754 4.296.795.621 1.906 1.141 3.333 1.56l-7.328 9.487 11.797 2.38 7.276-9.427c2.922.935 5.284 2.36 7.083 4.272 2.445 2.599 3.667 6.1 3.667 10.5 0 2.6-.452 5.012-1.355 7.24-.904 2.174-2.259 4.083-4.066 5.727-1.807 1.59-4.039 2.837-6.696 3.739-2.604.901-5.66 1.352-9.167 1.352z"
			fill="#7F5AF0" />
		<path fill-rule="evenodd" clip-rule="evenodd"
			d="M103.127 31.843l.072-16.045h-.112l-10.432 29.54-10.432-29.521H71.791V0h14.15l6.874 19.336h.64L100.328 0h13.19v46.664h-10.392v-14.82zm-31.336 25.59v-30.96h10.368l.024 5.37v25.59H71.791z"
			fill="#7F5AF0" />
		<path d="M265.857 57.433v-9.785h11.958V9.785h-9.361V0h33.276v9.784h-11.958v37.864h8.299v9.785h-32.214z"
			fill="#D9376E" />
		<path
			d="M6.157 26.648l9.236 9.235 9.235-9.235 6.157 6.157-9.235 9.235 9.235 9.236-6.157 6.157-9.235-9.236-9.236 9.236L0 51.276l9.236-9.236L0 32.805l6.157-6.157z"
			fill="#2CB67D" />
		<path d="M44.372 0v13.061h13.06v8.707h-13.06V34.83h-8.708V21.77h-13.06V13.06h13.06V0h8.708z" fill="#7F5AF0" /></svg>

	</header>

	<main 
		style="-moz-user-select: none; -webkit-user-select: none; -ms-user-select:none; user-select:none;-o-user-select:none;" 
		unselectable="on"
		onselectstart="return false;" 
		onmousedown="return false;"
	>
		<div id="game-container"></div>
	</main>

	<footer>
		<button type="button" title="Mover para esquerda" class="inputButton" data-code="ArrowLeft">
			<svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path d="M3.81596e-07 32L64 7.63192e-07L64 64L3.81596e-07 32Z" fill="#7F5AF0" />
			</svg>
		</button>
		<button type="button" title="Mover para baixo" class="inputButton" data-code="ArrowDown">
			<svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path d="M32 64L-5.59506e-06 9.40975e-06L64 3.8147e-06L32 64Z" fill="#7F5AF0" />
			</svg>
		</button>
		<button type="button" title="Mover para a direita" class="inputButton" data-code="ArrowRight">
			<svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path d="M64 32L1.01717e-06 64L3.8147e-06 -2.79753e-06L64 32Z" fill="#7F5AF0" />
			</svg>
		</button>
	</footer>
	
	<div id="game-over-modal" class="modal" style="display: none;">
		<div class="modal__container">
			<h2>Game over!</h2>
			<p>VocÃª fez 231 pontos</p>
			<button type="button" title="Jogar novamente!" onClick="window.location.reload();">Jogar novamente!</button>
		</div>
	</div>
	
	<script>
		function setDocHeight() {
			document.documentElement.style.setProperty(
				"--vh",
				`${window.innerHeight / 100}px`
			);
		}
		addEventListener("resize", setDocHeight);
		addEventListener("orientationchange", setDocHeight);
	</script>

	<script src="helpers.js"></script>
	<script src="block-logic.js"></script>
	<script src="Matrix.js"></script>
	<script src="Game.js"></script>
	<script>
		let game = new Game(11, 10);
		let gameContainer = document.querySelector('#game-container');

		function render() {
			gameContainer.innerHTML = game.HTMLrendering(gameOverModal);
		}

		// TODO: Better modal handling for game over 
		let gameOverModal = document.querySelector('#game-over-modal');

		function play(input) {
			game.update(input);
			render();
		}

		// Movement input from buttons
		for (btn of document.querySelectorAll('.inputButton')) {
			btn.onclick = function () {
				play(this.dataset.code) //HTML data-code attribute
			};
		}

		// Movement input from arrow keys
		const arrowKeys = ["ArrowLeft", "ArrowDown", "ArrowRight"];
		document.addEventListener('keydown', function (event) {
			if (arrowKeys.includes(event.code))
				play(event.code);
		});
		
		game.start();
		render();
	</script>
	
</body>
</html>